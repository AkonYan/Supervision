<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cethik.irmp.mapper.ChannelMapper">
  <resultMap id="BaseResultMap" type="com.cethik.irmp.model.Channel">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="channel_code" jdbcType="VARCHAR" property="channelcode" />
    <result column="gbdevice_code" jdbcType="VARCHAR" property="gbdevicecode" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="ip" jdbcType="VARCHAR" property="ip" />
    <result column="port" jdbcType="INTEGER" property="port" />
    <result column="address" jdbcType="VARCHAR" property="address" />
    <result column="online_status" jdbcType="INTEGER" property="onlinestatus" />
    <result column="manufacturer" jdbcType="VARCHAR" property="manufacturer" />
    <result column="register_way" jdbcType="INTEGER" property="registerway" />

    <result column="model" jdbcType="VARCHAR" property="model" />
    <result column="longitude" jdbcType="VARCHAR" property="longitude" />
    <result column="latitude" jdbcType="VARCHAR" property="latitude" />

    <association property="streaminfo" javaType="com.cethik.irmp.model.Servers">
      <result column="strm_lan_ip" jdbcType="VARCHAR"  property="lanip" />
      <result  column="strm_lan_port" jdbcType="INTEGER" property="lanport"/>
      <result column="strm_wan_ip" jdbcType="VARCHAR"  property="wanip" />
      <result  column="strm_wan_port" jdbcType="INTEGER" property="wanport"/>
    </association>
    <association property="registerinfo" javaType="com.cethik.irmp.model.Servers">
      <result column="reg_lan_ip" jdbcType="VARCHAR"  property="lanip" />
      <result  column="reg_lan_port" jdbcType="INTEGER" property="lanport"/>
      <result column="reg_wan_ip" jdbcType="VARCHAR"  property="wanip" />
      <result  column="reg_wan_port" jdbcType="INTEGER" property="wanport"/>
    </association>
  </resultMap>
  <select id="selectByCode" parameterType="java.lang.String"   resultMap="BaseResultMap">
  SELECT  channel.id,  channel.channel_code, channel.gbdevice_code, channel.`name`, channel.ip, channel.`port`, channel.online_status,
channel.manufacturer, channel.address, channel.register_way, channel.model, channel.longitude, channel.latitude,
reg.lan_ip as reg_lan_ip , reg.lan_port as reg_lan_port, reg.wan_ip as reg_wan_ip , reg.wan_port reg_wan_port,
strm.lan_ip as strm_lan_ip , strm.lan_port as strm_lan_port, strm.wan_ip as strm_wan_ip, strm.wan_port as strm_wan_port
 FROM
channel  INNER JOIN servers reg ON channel.register_server_id = reg.id
INNER JOIN servers strm ON channel.stream_server_id = strm.id
where  channel.channel_code =  #{channelcode,jdbcType=VARCHAR}

  </select>

</mapper>